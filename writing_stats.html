<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OBS Debug Test</title>
  <style>
    body {
      background-color: transparent;
      color: white;
      font-family: sans-serif;
      font-size: 2em;
      margin: 0;
      padding: 20px;
    }
  </style>
</head>
<body>
  <div id="status">Loading...</div>

  <script type="module">
    console.log('--- Module Script Init ---');
    document.getElementById('status').textContent = 'Script loaded!';

    const testVar = "Hello from script!";
    console.log('testVar:', testVar);
    console.log('Type of testVar:', typeof testVar);

    // This is your actual Apps Script URL
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby5HQj1OaRNw2Vcnnz1N9Rh7mGxzoWv5q2N9XQNX4WgXNjpdRbwyhfXIXLizcRitgFS/exec';

    async function fetchData() {
      console.log('fetchData function called.');
      document.getElementById('status').textContent = 'Fetching data...';
      try {
        console.log('Attempting to fetch from:', APPS_SCRIPT_URL);
        const response = await fetch(APPS_SCRIPT_URL);
        console.log('Fetch response received. Status:', response.status);

        if (!response.ok) {
          const errorText = await response.text();
          console.error(`HTTP error! Status: ${response.status}`, errorText);
          document.getElementById('status').textContent = `HTTP Error ${response.status}!`;
          return;
        }

        const data = await response.json();
        console.log('Parsed data:', data);
        document.getElementById('status').textContent = `Data: ${data['Words Today'] || 'N/A'} | ${data['Current Book'] || 'N/A'}`;

      } catch (error) {
        console.error('An error occurred during fetch or data parsing:', error);
        document.getElementById('status').textContent = `Fetch/Parse Error! Check console.`;
      }
    }

    fetchData();
    setInterval(fetchData, 15000); // Refresh every 15 seconds
  </script>
</body>
</html>
